# -*- coding: utf-8 -*-
"""CertifiedDataBoy.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1oK-XytjsxU8kr3QWJ7D4Y_UYM_xTlieT
"""

from torch.utils.data import Dataset
import json
import glob


class DrakeDataset(Dataset):
    def __init__(self, path):
        self.path = path
        self.lyrics = self.iter_over_json()

    def __len__(self):
        return len(self.lyrics)

    def __getitem__(self, idx):
        return self.lyrics[idx]

    def read_json(self):
        files = glob.glob(f"{self.path}")
        for file in files:
          with open(file) as f:
            all_data = json.load(f)
            data = {piece["lyrics_title"]: piece["lyrics"] for piece in all_data if piece["lyrics"] != None}
            return data

    def iter_over_json(self):
        data = self.read_json()
        lyrics_strings = [l for l in data.values()]
        for idx, key in enumerate(data):
            try:
                text = ""
                text += key
                text += data[key] # lyrics
                lyrics_strings.append(text)
                
            except Exception:
                pass
        return lyrics_strings

# ds = DrakeDataset("archive")

# # for i in range(len(ds)):
# #   data = ds[i]
# #   print(data)

# !ls archive/*.json

